<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Math Operations</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css?family=Inter:400,700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .glass {
        background: rgba(255, 255, 255, 0.85);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        backdrop-filter: blur(6px);
        -webkit-backdrop-filter: blur(6px);
        border-radius: 1.5rem;
        border: 1.5px solid #e5e7eb;
      }
      .input-pill {
        @apply rounded-full px-6 py-3 border-2 border-gray-300 focus:border-blue-400 focus:outline-none bg-white text-lg shadow;
      }
      .result-label {
        @apply text-gray-500 text-base font-medium;
      }
      .result-value {
        @apply text-gray-800 text-xl font-bold ml-2;
      }
      /* Remove number input arrows for Chrome, Safari, Edge */
      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      /* Remove number input arrows for Firefox */
      input[type="number"] {
        -moz-appearance: textfield;
      }
    </style>
  </head>
  <body
    class="bg-gradient-to-br from-blue-100 via-white to-pink-100 min-h-screen flex flex-col relative"
  >
    <!-- Background image with low opacity -->
    <div class="absolute inset-0 pointer-events-none select-none z-0">
      <img
        src="./background.png"
        alt="background"
        class="w-full h-full object-cover opacity-10"
        draggable="false"
      />
    </div>
    <nav class="w-full flex items-center absolute top-0 left-0 pt-8 pl-8 z-20">
      <a
        href="../index.html"
        class="text-gray-800 hover:text-gray-900 font-bold underline text-lg transition"
      >
        <-- Back
      </a>
    </nav>
    <main
      class="flex flex-col items-center justify-center min-h-screen py-12 px-2 relative z-10"
    >
      <div
        class="glass z-10 max-w-xl w-full mx-auto p-10 flex flex-col items-center shadow-2xl mt-16"
      >
        <h1
          class="text-4xl font-bold text-gray-800 mb-2 tracking-tight text-center"
        >
          Math Operations
        </h1>
        <p class="text-lg text-gray-500 mb-8 text-center">
          Enter numbers one at a time. Press
          <span class="font-semibold text-gray-700">Enter</span> or click
          <span class="font-semibold text-gray-700">Add</span> to add to the
          list.
        </p>
        <div class="w-full mb-8">
          <label
            for="input-box"
            class="block text-gray-700 text-lg font-semibold mb-2"
          >
            Enter a number:
          </label>
          <div class="flex gap-2">
            <input
              id="input-box"
              type="text"
              inputmode="decimal"
              pattern="[0-9]*"
              placeholder="e.g. 12"
              autocomplete="off"
              class="w-full rounded-full px-6 py-3 border-2 border-gray-300 focus:border-blue-400 focus:outline-none bg-white text-lg shadow transition appearance-none"
              style="
                /* Remove number input arrows for all browsers */
                -moz-appearance: textfield;
              "
            />
            <button
              id="add-btn"
              class="bg-blue-500 hover:bg-blue-600 text-white font-bold px-6 rounded-3xl shadow transition"
              type="button"
            >
              Add
            </button>
          </div>
          <span id="err" class="block text-red-500 mt-2 text-sm"></span>
        </div>
        <div class="w-full mb-6">
          <div class="mb-2 text-gray-700 font-semibold">Current List:</div>
          <div
            id="number-list"
            class="flex flex-wrap gap-2 text-base text-gray-700"
          ></div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full">
          <div class="flex flex-col">
            <span class="result-label">Maximum</span>
            <span id="max" class="result-value"></span>
          </div>
          <div class="flex flex-col">
            <span class="result-label">Minimum</span>
            <span id="min" class="result-value"></span>
          </div>
          <div class="flex flex-col">
            <span class="result-label">Sum</span>
            <span id="sum" class="result-value"></span>
          </div>
          <div class="flex flex-col">
            <span class="result-label">Average</span>
            <span id="average" class="result-value"></span>
          </div>
          <div class="flex flex-col md:col-span-2">
            <span class="result-label">Reverse Order</span>
            <span id="reverse-order" class="result-value break-all"></span>
          </div>
        </div>
        <button
          id="clear"
          class="mt-10 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-8 rounded-full shadow transition"
        >
          Clear All
        </button>
      </div>
    </main>
    <script>
      // filepath: /Users/iktisadrashid/Documents/cse391-JS-Assignment/BasicMathOperations/operations.html
      document.addEventListener("DOMContentLoaded", () => {
        const inputBox = document.getElementById("input-box");
        const addBtn = document.getElementById("add-btn");
        const err = document.getElementById("err");
        const maxSpan = document.getElementById("max");
        const minSpan = document.getElementById("min");
        const sumSpan = document.getElementById("sum");
        const avgSpan = document.getElementById("average");
        const revSpan = document.getElementById("reverse-order");
        const clearBtn = document.getElementById("clear");
        const numberList = document.getElementById("number-list");

        let numbers = [];

        function renderList() {
          numberList.innerHTML = numbers
            .map(
              (n) =>
                `<span class="bg-gray-200 px-3 py-1 rounded-full">${n}</span>`
            )
            .join("");
        }

        function updateResults() {
          if (numbers.length === 0) {
            err.textContent = "";
            maxSpan.textContent = "";
            minSpan.textContent = "";
            sumSpan.textContent = "";
            avgSpan.textContent = "";
            revSpan.textContent = "";
            renderList();
            return;
          }
          err.textContent = "";
          maxSpan.textContent = Math.max(...numbers);
          minSpan.textContent = Math.min(...numbers);
          sumSpan.textContent = numbers.reduce((a, b) => a + b, 0);
          avgSpan.textContent = (
            numbers.reduce((a, b) => a + b, 0) / numbers.length
          ).toFixed(2);
          revSpan.textContent = numbers.slice().reverse().join(", ");
          renderList();
        }

        // Only allow numbers, decimal, and minus sign in input
        inputBox.addEventListener("input", (e) => {
          let value = e.target.value;
          // Remove all except digits, decimal point, and minus at start
          value = value.replace(/(?!^)-|[^0-9.-]/g, "");
          // Only one minus at the start
          value = value.replace(/(?!^)-/g, "");
          // Only one decimal point
          const parts = value.split(".");
          if (parts.length > 2) {
            value = parts[0] + "." + parts.slice(1).join("");
          }
          e.target.value = value;
        });

        function addNumber() {
          const value = inputBox.value.trim();
          // Only allow valid numbers (integer or decimal)
          if (!/^-?\d*\.?\d+$/.test(value)) {
            err.textContent =
              value === "" ? "Please enter a number." : "Invalid number.";
            return;
          }
          const num = Number(value);
          if (isNaN(num)) {
            err.textContent = "Invalid number.";
            return;
          }
          numbers.push(num);
          inputBox.value = "";
          err.textContent = "";
          updateResults();
        }

        addBtn.addEventListener("click", addNumber);

        inputBox.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            addNumber();
          }
        });

        clearBtn.addEventListener("click", () => {
          numbers = [];
          inputBox.value = "";
          updateResults();
        });

        // Initialize on load
        updateResults();
      });
    </script>
  </body>
</html>
